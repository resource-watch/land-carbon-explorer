(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{409:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return rt}});var n=a(2809),r=a(7294),o=a(8093),i=a(9226),s=a(5564),l=a.n(s),c=a(9008),d=a(9753),u=a(4341),h=a(1631),p=i.v9,m=a(7813),f=a.n(m),g=a(7325),b=a(8350),y=a(8767),w=a(6388),v=JSON.parse('{"data":[{"type":"dataset","id":"test-dataset-1","attributes":{"name":"[internal] Test layer 1","active":true,"subtitle":"","metadata":[{"type":"metadata","attributes":{"language":"en","name":"Test Layer 1","description":"This is a **test** _description_ that should support [markdown](https://land.resourcewatch.org).","source":"Vizzuality","info":{"rwId":null,"data_type":"Raster","name":"Test Layer 1","sources":[{"source-name":"Vizzuality","id":0,"source-description":""}],"technical_title":"Test layer 1: this is the name of the publication","functions":"A layer for testing the LCL app","cautions":"Don\'t let this layer get into prod!","citation":"Gassert, Francis, et al. 2021 \'Test layer 1\'. Unpublished.","license":"Creative Commons Attribution 4.0 International","license_link":"https://creativecommons.org/licenses/by/4.0/","geographic_coverage":"Global","spatial_resolution":"30 m","date_of_content":"2020","frequency_of_updates":null,"learn_more_link":"https://resourcewatch.org","data_download_link":null,"data_download_original_link":"https://resourcewatch.org"}}}],"layer":[{"type":"layer","id":"test-layer-1","attributes":{"name":"Test layer 1","dataset":"test-dataset-1","description":"A test layer.","provider":"leaflet","type":"raster","layerConfig":{},"source":{"tiles":["https://storage.googleapis.com/lcl_tiles/test_snow_type/{z}/{x}/{y}.png"],"minzoom":1,"maxzoom":5},"legendConfig":{"type":"basic","items":[{"name":"Legend class","color":"#DA6497","id":0}]}}}]}},{"type":"dataset","id":"test-dataset-2","attributes":{"name":"[internal] 2000-2020 Forest Height and Extent","active":true,"subtitle":"","metadata":[{"id":"616f11c36cd78b001acc1b6e","type":"metadata","attributes":{"dataset":"64a3e126-000b-46fb-aaf4-8ac765a8263b","application":"rw","resource":{"id":"64a3e126-000b-46fb-aaf4-8ac765a8263b","type":"dataset"},"language":"en","name":"Forest Height and Extent","description":"### Overview  \\n  \\n_**Forest Height and Extent data is still a draft product and data are subject to change in the future.**_\\r\\n  \\n  \\nThe 30 metres spatial resolution global forest canopy height map was developed through the integration of the [Global Ecosystem Dynamics Investigation (GEDI)](https://gedi.umd.edu/) lidar forest structure measurements and [Landsat analysis-ready data (Landsat ARD)](https://www.usgs.gov/core-science-systems/nli/landsat/us-landsat-analysis-ready-data?qt-science_support_page_related_con=0#qt-science_support_page_related_con) time series. The NASA GEDI is a spaceborne lidar instrument operating onboard the International Space Station since April 2019. It provides point-based measurements of vegetation structure, including forest canopy height between 52\xb0N and 52\xb0S globally. The Global Land Analysis and Discover (GLAD) team at the University of Maryland (UMD) integrated the GEDI point-based forest height measurements with the global wall-to-wall Landsat analysis-ready time-series data (Landsat ARD). The GEDI relative height at 95% (GEDI RH95) metric was used to calibrate the model. The Landsat multi-temporal metrics that represent the surface phenology serve as the independent variables for global forest height modeling. The \u201cmoving window\u201d locally calibrated and applied regression tree ensemble model was implemented to ensure high quality of forest height prediction and global map consistency. The model was extrapolated in the boreal regions to create the global forest height prototype map. The model was applied for the years 2000 and 2020 and the maps were temporally filtered to provide a two-decade global forest structure and change metrics.\\r\\n\\r\\n  \\n  \\nThe GLAD laboratory in the Department of Geographical Sciences at UMD investigates methods, causes and impacts of global land surface change.  Earth observation imagery are the primary data source and land cover extent and change the primary topic of interest. GLAD aspires to generate new science insights concerning land resources, educate the next generation of remote sensing-based land change scientists, and disseminate land monitoring capabilities to operational settings nationally and internationally.  \\n  \\n### Methodology  \\n  \\nThe year 2000 and 2020 global forest height was modeled through the integration of the Global Ecosystem Dynamics Investigation (GEDI) lidar forest structure measurements and Landsat analysis-ready data (Landsat ARD) time-series. The NASA GEDI is a spaceborne lidar instrument operating onboard the International Space Station since April 2019. It provides point-based measurements of vegetation structure between 52\xb0N and 52\xb0S globally [(Dubayah et al., 2020)](https://www.sciencedirect.com/science/article/pii/S2666017220300018). The GEDI relative height of returned energy (RH) metrics were filtered to exclude low quality observations and gridded to the Landsat 30-m spatial resolution. he RH metrics were compared with 90th percentile of the forest height at 30-m pixel resolution derived from the airborne lidar instruments and found that the GEDI RH95 (relative height at 95%) metric is highly correlated with the airborne lidar canopy height product. This metric was selected as the calibration data for the global forest height map. To exclude non-woody vegetation from the training,  a zero height was assigned to all GEDI observations with RH95 values below 3 meters.\\r\\n\\r\\n  \\n  \\nA global 16-day normalized surface reflectance Landsat ARD was employed as input data for forest height modeling [(Potapov et al., 2020)](https://www.sciencedirect.com/science/article/pii/S0034425720305381?via%3Dihub). The per-pixel 16-day time-series data were composed only of clear-sky observations during the snow-free season.  A set of annual multitemporal metrics was generated to provide consistent land surface phenology inputs for model application. To facilitate spatiotemporal consistency of the reflectance time-series, gap-filling of the missing 16-day data with data from preceding years was implemented. Annual metrics include selected ranks, inter-rank averages, and amplitudes of surface reflectance and vegetation indices values, and surface reflectance averages for land surface phenology stages defined by vegetation indices (i.e., surface reflectance for the maximum and minimum greenness periods). The Landsat metrics were augmented with elevation data.\\r\\n\\r\\n  \\n  \\nThe2019 GEDI RH95 was used as a dependent variable and the Landsat multitemporal metrics from the same year as independent variables to calibrate the regression tree ensembles. A separate model was calibrated for each Landsat ARD tile (1\xd71\xb0) using training data collected within the neighboring tiles. The prototype for the boreal forest height map, where GEDI data were absent (north of 52\xb0N), was calibrated using training data extracted from the modeled forest height between 40\xb0N and 52\xb0N. To address the overestimation of tree height over wetlands and tundra, additional non-forest training was manually collected in areas indicated as treeless by the year 2010 tree canopy cover product (Hansen et al., 2013).\\r\\n\\r\\n  \\n  \\nThe model calibrated for the year 2019 was applied to the multitemporal metrics for other years (2000-2003 and 2017-2020). The forest height value for the years 2000 and 2020 was calculated as the median of 2000, 2001, 2003 and 2017, 2019, 2020, respectively, unless forest loss was indicated by the forest change product [(Hansen et al., 2013)](https://pubmed.ncbi.nlm.nih.gov/24233722/). To reduce errors and noise in the model outputs due to remaining atmospheric contamination and differences in the radiometric resolution of Landsat sensors in 2000 and 2020, extensive filtering of the output products was implemented. Pixels that did not experience forest loss according to the Hansen et al. (2013) product and that had an overlap of ranges of forest height values for 2000-2003 and 2017-2020 intervals were considered stable forests. Manual masks were also used to clean up incorrectly mapped forest loss and gain, especially in the short seasonal forests. \\r\\n\\r\\nFor the full documentation, please click on the \u201cLearn more\u201d button.\\r\\n  \\n  \\n### Additional Information  \\n  \\nResource Watch shows only a subset of the dataset. For access to the full dataset and additional information, click on the \u201cLearn more\u201d button.  \\n  \\n### Visualizing the Data  \\n  \\nOur team reformatted this dataset before displaying it on Resource Watch.","source":"UMD","info":{"rwId":"for.032.rw0","data_type":"Raster","name":"Forest Height and Extent","sources":[{"source-name":"","id":0,"source-description":"University of Maryland (UMD)"}],"technical_title":"Global forest height mapped through the integration of GEDI and Landsat data, 2000 and 2020","functions":"[Draft] Forest canopy height and change for the years 2000 and 2020","cautions":"-A probability-based sample analysis is the recommended good practice approach to estimating land cover and land use extent and change. The global land cover map time-series enables a higher sampling efficiency through stratification at the sub-national, national, and global scales. The maps should not be used as the only source data for national and international reporting due to unknown variability of map uncertainty in space and between years.\\r\\n  \\n  \\n- The forest height product has issues related to GEDI data quality and Landsat data availability. GEDI data overestimate forest height on slopes within temperate and subtropical mountain grasslands, e.g., in New Zealand and Lesotho. The tree height over cities and suburbs may be confounded with the building height, as GEDI data do not discriminate between the height of vegetation and man-made objects. The GEDI calibration uncertainties, specifically geolocation precision and land surface height estimation, may be responsible for some of the map errors. \\r\\n  \\n  \\n- The tree height model saturated above 30 metres and may not adequately represent the height of the tallest trees. The forest extent may be inconsistent for the areas with short (4-6 meters) seasonal forests.\\r\\n  \\n  \\n- The forest height model above 52\xb0N (the GEDI data range) is a prototype derived using a combination of GEDI data below 52\xb0N and non-forest training data collected manually above 52\xb0N. The product may incorrectly represent the height of the boreal forests, especially in the far North. \\r\\n  \\n  \\n- The model application for the year 2000 may over/underestimate the tree canopy height due to the different radiometric properties of the Landsat ETM/TM and Landsat OLI sensors. The forest height change between the years 2000 and 2020 was temporally filtered and manually corrected to remove most of the artifacts. This correction, however, may reduce the product sensitivity to forest height changes (i.e., some of the forest loss and gain events may be omitted).\\r\\n","citation":"(1) Potapov, P., Li, X., Hernandez-Serna, A., Tyukavina, A., Hansen, M.C., Kommareddy, A., Pickens, A., Turubanova, S., Tang, H., Silva, C.E. and Armston, J., 2021. Mapping global forest canopy height through integration of GEDI and Landsat data. Remote Sensing of Environment, 253, p.112165. Accessed through Resource Watch, (date). [www.resourcewatch.org](https://www.resourcewatch.org).\\r\\n","license":null,"license_link":null,"geographic_coverage":"52N - 52S","spatial_resolution":"30 m","date_of_content":"2000 and 2020","frequency_of_updates":"Unknown","learn_more_link":"https://www.sciencedirect.com/science/article/pii/S0034425720305381?via%3Dihub","data_download_link":null,"data_download_original_link":"https://www.sciencedirect.com/science/article/pii/S0034425720305381?via%3Dihub"},"createdAt":"2021-10-19T18:43:15.979Z","updatedAt":"2021-10-19T18:43:15.980Z","status":"published"}}],"layer":[{"type":"layer","id":"forest-height-and-extent","attributes":{"name":"2000-2020 Forest Height and Extent","dataset":"test-dataset-2","description":"Stable forest height, forest height change (gain and loss) between 2000 and 2020. The forest height change refers to areas with forest height increase (gain) and forest height decrease or change to other land uses (loss) between 2000 and 2020.","provider":"leaflet","type":"raster","layerConfig":{},"source":{"tiles":["https://storage.googleapis.com/lcl_tiles/GLCLU2020/forest/{z}/{x}/{y}.png"],"minzoom":1,"maxzoom":12},"legendConfig":{"items":[{"color":"#c1e866","name":"Stable Low Forest  (5-10m)","id":0},{"color":"#97bd3d","name":"Stable Medium Forest (10-20m)","id":1},{"color":"#689106","name":"Stable Tall Forest (20+m)","id":2},{"color":"#f59fc8","name":"Small Net Forest Height Gain (5-10m gain)","id":3},{"color":"#dc5796","name":"Large Net Forest Height Gain (10+m gain)","id":4},{"color":"#a280ff","name":"Small Net Forest Height Loss (5-10m loss)","id":5},{"color":"#4600ff","name":"Large Net Forest Height Loss (10+m loss)","id":6}],"type":"basic"}}}]}},{"type":"dataset","id":"test-dataset-3","attributes":{"name":"[internal] Water Extent and Change","active":true,"subtitle":"","metadata":[{"id":"615decfa6cd78b001acc1b67","type":"metadata","attributes":{"dataset":"b83ad197-eb95-44e2-8ec3-3351ab926421","application":"rw","resource":{"id":"b83ad197-eb95-44e2-8ec3-3351ab926421","type":"dataset"},"language":"en","name":"Water Extent and Change","description":"### Overview  \\n  \\n_**The Water data is still a draft product and data are subject to change in the future**_\\n  \\n  \\nThe global annual surface water percent and surface water dynamics maps were created by the Global Land Analysis and Discovery Lab (GLAD) laboratory, and the data is available at 30-meter spatial resolution, globally, from 1999 to 2020. The GLAD laboratory classified all available Landsat 5, 7, and 8 scenes. Each scene was classified per pixel to identify land, water, and ground obscured by cloud, shadow, haze, or ice. Land and water observations were summed by month from all available images. These counts were aggregated to estimate the annual temporal percent of the year each pixel had water presence, resulting in values of 0-100, and pixels with no observations a no-data value of 255. In order to characterize the type of surface water dynamic over the 22 years, the annual water percent was estimated for each year and temporally filtered to provide greater consistency. A series of rules were applied to this time series to characterize it into permanent land or water, stable seasonal, unidirectional loss or gain, temporary dry or wet period, and high-frequency transitions between annual states of water and land. These classes are mapped both as discrete classes and as a continuum representing the class and percent water. \\n  \\n  \\nThe Global Land Analysis and Discovery Lab (GLAD) laboratory in the Department of Geographical Sciences at UMD investigates methods, causes, and impacts of global land surface change.  Earth observation imagery is the primary data source, and the land cover extent and change is the primary topic of interest. GLAD aspires to generate new science insights concerning land resources, educate the next generation of remote sensing-based land change scientists, and disseminate land monitoring capabilities to operational settings nationally and internationally.\\n  \\n  \\n### Methodology  \\n  \\nOpen surface water, or simply water, is defined as inland water that covers \u226550% of a pixel and is not obscured by objects on or above the water surface, for example, forest canopy, floating aquatic vegetation, bridges, or ice. The analysis had three major steps: (1) classify every Landsat scene 1999-2020; (2) create an annual percent water time-series; and (3) characterize the time-series into various dynamics classes. \\r\\n  \\n  \\nAll Landsat 5, 7, and 8 scenes from 1999-2020 were classified into land, water, and unusable data. Due to the diversity of reflectance patterns for open surface water targets, an ensemble of hierarchical, bagged classification trees were used to discriminate clear observations from those contaminated by cloud, shadow, and ice and to discriminate water from land. These classification trees were developed from a training set of 150-180 fully labeled scenes per sensor [(Potapov et al., 2015)](https://doi.org/10.1016/j.rse.2014.11.027). The classification models utilize all the Landsat bands, normalized difference ratios of each pair of spectral bands, and 3x3 pixel spatial averages of all bands and ratios, as well as, utilize topographic inputs of elevation and derived slope, aspect, and hillshade data.\\r\\n  \\n  \\nThe annual water percent time series was derived from the counts of water and land observations. To account for intra-annual variation in clear observation frequency (e.g. fewer observations in the far north in winter due to low sun elevations or in tropical monsoon environments due to high cloud cover), the percent of land and water observations flagged as water (water / (water + land)) was first calculated per meteorological season (December-February, March-May, June-August, September-November) of each year. Then the average water percent of the seasons with data was assigned as the annual water percent. Temporal filters and manual masks were applied to remove noise and omission/commission errors. \\r\\n  \\n  \\nAn inter-annual water dynamics model was developed to characterize and visualize the dynamics of water presence 1999-2020. The annual water percent time series was first smoothed using a 3-year mean moving window, and the range and mean were calculated per pixel. Pixels with a range of \u226433% and a mean of \u226410% or \u226590% were labeled permanent land and water, respectively, providing a stable target with low sensitivity to possible omission or commission effects due to image artifacts or atmospheric conditions. Change pixels were identified as pixels with a range of \u226550%, and all other pixels labeled as stable seasonal, characterized by having little or no inter-annual variation in water presence and consistent intra-annual variation. By an analysis of all local maxima and minima in the time-series, pixels labeled as change were further characterized into the following main change types: gain, loss, dry period (water-land-water), wet period (land-water-land), and high-frequency (3 or more) land-water transitions. For more details, please refer to Pickens et al. [(2020)](https://doi.org/10.1016/j.rse.2020.111792).\\r\\n  \\n  \\nFor the full documentation, please click on the \u201cLearn more\u201d button.  \\n  \\n### Additional Information  \\n  \\nResource Watch shows only a subset of the dataset. For access to the full dataset and additional information, click on the \u201cLearn more\u201d button.  \\n  \\n### Visualizing the Data  \\n  \\nOur team reformatted this dataset before displaying it on Resource Watch.  \\n  \\n### Disclaimer  \\n  \\nExcerpts of this description page were taken from the source metadata.","source":"UMD","info":{"rwId":"wat.002.rw0","data_type":"Raster","name":"Water Extent and Change","sources":[{"source-name":"","id":0,"source-description":"University of Maryland (UMD)"}],"technical_title":"Global surface water dynamics 1999-2020","functions":"[Draft] Global surface water dynamics from the year 1999 to 2020","cautions":"- A probability-based sample analysis is the recommended good practice approach to estimating land cover and land use extent and change. The global surface water dynamics map enables a higher sampling efficiency through stratification at the sub-national, national, and global scales. The map should not be used as the only source data for national and international reporting due to unknown map uncertainty that may vary in space and between time intervals.\\n  \\n  \\n- Ice cover, lava, dark vegetation cover, high turbidity or very shallow water, the combination of unmasked shadow or haze with one of these covers, and mixed pixels are the most common sources of error in mapped water and land in the Landsat imagery.\\n  \\n  \\n- The dynamics map overestimates the extent of dynamic water presence, labeling some of the reference areas of permanent water or land as places with dynamic water presence. Much of this overestimation is within the above land covers or in the mixed pixels on the edge of water bodies. Conversely, the areas mapped as permanent water or land can be used with high confidence, committing only 1.2 (\xb10.7)% and 0.1 (\xb10.0)%, respectively.\\n  \\n  \\n- Individual classes representing dynamic water presence should be used with care, having lower accuracies. However, most errors are either mixed pixels or real dynamics mislabeled as another type of dynamic water presence rather than as permanent land or water.","citation":"Pickens, A.H., Hansen, M.C., Hancher, M., Stehman, S.V., Tyukavina, A., Potapov, P., Marroquin, B., Sherani, Z., 2020. Mapping and sampling to characterize global inland water dynamics from 1999 to 2018 with full Landsat time-series. Remote Sensing of Environment 243, 111792. [https://doi.org/10.1016/j.rse.2020.111792](https://doi.org/10.1016/j.rse.2020.111792). Accessed through Resource Watch, (date). [www.resourcewatch.org](https://www.resourcewatch.org).","license":null,"license_link":null,"geographic_coverage":"Global","spatial_resolution":"30 m","date_of_content":"2000-2020","frequency_of_updates":"Unknown","learn_more_link":"https://doi.org/10.1016/j.rse.2020.111792","data_download_link":null,"data_download_original_link":"https://doi.org/10.1016/j.rse.2020.111792"},"createdAt":"2021-10-06T18:37:46.118Z","updatedAt":"2021-10-19T18:46:55.933Z","status":"published"}}],"layer":[{"type":"layer","id":"water-extent-change","attributes":{"name":"2000-2020 Water extent and change","dataset":"test-dataset-3","description":"Surface water extent and change from 2000 to 2020. Pixels with a range of \u226433% and a mean of \u226590% were labeled permanent water. Change pixels were identified as pixels with a range of \u226550%, and all other pixels were labeled as stable seasonal. Pixels labeled as change were further characterized into the following main change types: gain, loss, variable water (dry period, wet period, high frequency), and probable waters.","provider":"leaflet","type":"raster","layerConfig":{},"source":{"tiles":["https://storage.googleapis.com/lcl_tiles/GLCLU12020/water/{z}/{x}/{y}.png"],"minzoom":1,"maxzoom":12},"legendConfig":{"items":[{"color":"#6baed6","name":"Permanent Water","id":0},{"color":"#c6dbef","name":"Seasonal Water","id":1},{"color":"#80cdc1","name":"Variable Water","id":2},{"color":"#08519c","name":"Water Gain","id":3},{"color":"#a17247","name":"Water Loss","id":4}],"type":"basic"}}}]}},{"type":"dataset","id":"test-dataset-4","attributes":{"name":"[internal] Cropland extent and change","active":true,"subtitle":"","metadata":[{"id":"61561bfbd32fb1001aad822a","type":"metadata","attributes":{"dataset":"e552ecb6-409e-484c-8bfb-0c0de2e2946e","application":"rw","resource":{"id":"e552ecb6-409e-484c-8bfb-0c0de2e2946e","type":"dataset"},"language":"en","name":"Cropland extent and change","description":"### Overview  \\n  \\n_**The Cropland extent and change data is still a draft product and data are subject to change in the future.**_\\n  \\n  \\nThe Cropland Extent and Change dataset at 30 metres spatial resolution was developed by the Global Land Analysis and Discovery Lab  (GLAD) at the University of Maryland (UMD) using Landsat satellite data time-series.Cropland is defined as land used to produce herbaceous crops for human consumption, forage and biofuel. Perennial woody crops, permanent pastures, and shifting cultivation are excluded from the definition. The fallow length is limited to four years for the cropland class. The map is based on the machine learning classification of the global Landsat data archive using locally calibrated models. Model calibration data were collected through visual interpretation of Landsat and high spatial resolution satellite images. The mapping was performed for the 2000-2003 and 2016-2019 time intervals. For each four-year interval, a 30x30 metres pixel was mapped as cropland if a growing crop was detected during any of these years. Cropland patches below 0.5 hectares were excluded from the final map. The cropland change refers to areas with cropland establishment (gain) and cropland abandonment or conversion to other land uses (loss) between 2000-2003 and 2016-2019 time intervals.\\n\\n  \\n  \\nGlobal population growth and increasing standards of living inevitably cause the expansion and intensification of global agricultural land use to fulfill growing demands for food, biofuel, and other commodities. In turn, agriculture expansion and intensification threaten ecosystem functioning and lead to species extinction through habitat loss and fragmentation. The [United Nations 2030 Sustainable Development Goals (SDGs)](https://www.undp.org/sustainable-development-goals) call for balancing increasing agricultural production with maintenance of ecosystem services. Implementation of SDG\u2019s to improve food security, protect freshwater and terrestrial ecosystems, and mitigate climate change require national policies and international cooperation that are based on consistent, independent, and timely data on agriculture extent and productivity. The Cropland Extent and Change dataset can serve as a tool for monitoring national and global progress towards SDG\u2019s.\\n\\n  \\n  \\nThe GLAD laboratory in the Department of Geographical Sciences at UMD investigates methods, causes and impacts of global land surface change.  Earth observation imagery are the primary data source and land cover extent and change the primary topic of interest. GLAD aspires to generate new science insights concerning land resources, educate the next generation of remote sensing-based land change scientists, and disseminate land monitoring capabilities to operational settings nationally and internationally.\\n  \\n  \\n### Methodology  \\n  \\nCropland is defined as land used for the production of annual and perennial herbaceous crops for human consumption, forage (including hay), and biofuel. Perennial woody crops, permanent pastures, and shifting cultivation are excluded from the definition. The fallow length is limited to four years for the cropland class. The cropland class definition is largely consistent with the arable land category reported by the [Food and Agriculture Organization (FAO) of the United Nations](https://www.fao.org/3/Y4171E/Y4171E20.htm).\\r\\n\\r\\n  \\n  \\nThe analysis was performed in four-year epochs, 2000-2003 and 2016-2019. One cropland map per epoch was created, named by the last year of the interval (e.g., the 2019 map represents the 2016-2019 epoch). Using a four-year interval (rather than a single year) increased the number of clear-sky satellite observations in the time-series, which improves the representation of land surface phenology and the accuracy of cropland detection. For each four-year interval, an area was mapped as cropland if a growing crop was detected during any of these years. This way, the criterion of the maximum fallow length was implemented: if an area was not used as cropland for more than four years, it was not included in the cropland map for the corresponding time interval.\\r\\n\\r\\n  \\n  \\nThe global 16-day normalized surface reflectance Landsat Analysis Ready Data (Landsat ARD) was employed as input data for cropland mapping [(Potapov et al., 2020)](https://www.mdpi.com/2072-4292/12/3/426). For each four-year interval, a single annualized gap-free 16-day observation time-series was created. For each 16-day interval, the observation with the highest near-infrared reflectance value was selected(to prioritize observations with the highest vegetation cover) from four years of Landsat data. The annualized 16-day time-series within each four-year interval was transformed into a set of multitemporal metrics that provide consistent land surface phenology inputs for global cropland mapping. Metrics include selected ranks, inter-rank averages, and amplitudes of surface reflectance and vegetation indices values, and surface reflectance averages for selected land surface phenology stages defined by vegetation indices (i.e., surface reflectance for the maximum and minimum greenness periods). The Landsat metrics were augmented with elevation data. \\r\\n\\r\\n  \\n  \\nGlobal cropland mapping included three stages that enabled extrapolation of visually delineated cropland training data to a temporally consistent global cropland map time-series using machine learning. At all three stages, a bagged decision tree ensembles was employed as a supervised classification algorithm that uses class presence and absence data as the dependent variable and a set of multitemporal metrics as independent variables at a Landsat ARD pixel scale. The first stage consisted of performing individual cropland classifications for a set of 924 Landsat ARD 1\xb0\xd71\xb0 tiles for the 2016-2019 interval. The tiles were chosen to represent diverse global agriculture landscapes. Classification training data (cropland class presence and absence) were manually selected through visual interpretation of Landsat metric composites and high-resolution data from Google Earth. At the second stage, the 924 tiles that had been classified as cropland/other land and the 2016-2019 metric set were used to train a series of regional cropland mapping models. The classification was iterated by adding training tiles and assessing the results until the resulting map was satisfactory. At the third stage, the preliminary global cropland maps were used as training data to generate temporally consistent global cropland data. The goal of this third stage was to create a robust spatiotemporally consistent set of locally calibrated cropland detection models. For each 1\xb0\xd71\xb0 Landsat ARD tile (13,451 tiles total) training data for each four-year interval was collected from the preliminary cropland extent maps within a 3\xb0 radius of the target tile, with preference to select stable cropland and non-cropland pixels as training. Training data from all intervals were used to calibrate a single decision tree ensemble for each ARD tile. The per-tile models were then applied to each time interval, and the results were post-processed to remove single cropland class detections and omissions within time-series and eliminate cropland patches below 0.5 ha. Manual masks to remove map artifacts (e.g., cropland overestimation over temperate wetlands and flooded grasslands) were applied in some regions to improve the final map.\\r\\n\\r\\n\\r\\nFor the full documentation, please click on the \u201cLearn more\u201d button.\\r\\n  \\n  \\n### Additional Information  \\n  \\nResource Watch shows only a subset of the dataset. For access to the full dataset and additional information, click on the \u201cLearn more\u201d button.  \\n  \\n### Visualizing the Data  \\n  \\nOur team reformatted this dataset before displaying it on Resource Watch.   \\n  \\n### Disclaimer  \\n  \\nExcerpts of this description page were taken from the source metadata.","source":"UMD","info":{"rwId":"foo.065.rw0","data_type":"Raster","name":"Cropland extent and change","sources":[{"source-name":"","id":0,"source-description":"University of Maryland (UMD)"}],"technical_title":"Global cropland extent and change, 2003-2019","functions":"[Draft] Cropland stability, gain and loss from 2000-2003 and 2016-2019\\r\\n","cautions":"  \\n  \\n- A probability-based sample analysis is the recommended good practice approach to estimating land cover and land use extent and change. The global land cover map time-series enables a higher sampling efficiency through stratification at the sub-national, national, and global scales. The maps should not be used as the only source data for national and international reporting due to unknown map uncertainty that may vary in space and between time intervals.\\r\\n  \\n  \\n- Cropland maps have higher accuracy in regions dominated by large-scale industrial farming, e.g. North and South America. In Europe, Asia, and Africa, the global map may underestimate small-scale cropland areas due to Landsat spatial resolution limitations in mapping heterogeneous landscapes.\\r\\n  \\n  \\n- Cropland class may be confused with the intensively managed permanent pastures as both classes have similar spectral response and phenology. This issue may cause an overestimation of cropland area in Australia, New Zealand, and parts of Western Europe.\\r\\n  \\n  \\n- Dryland rainfed agriculture and summer wheat production areas, especially when intermittent with long fallow, may be partially omitted in Central Asia and the Middle East. The short vegetation season and the lack of cloud-free Landsat data in some years may preclude dryland agriculture detection.\\r\\n  \\n  \\n- Croplands that were repeatedly abandoned and recultivated may be inconsistently mapped as cropland loss or gain.\\r\\n\\r","citation":"(1) P. Potapov, S. Turubanova, M.C. Hansen, A. Tyukavina, V. Zalles, A. Khan, X.-P. Song, A. Pickens, Q. Shen, J. Cortez. (2021) Accelerated expansion of global cropland extent in the 21st century. In Review. Accessed through Resource Watch, (date). [www.resourcewatch.org](https://www.resourcewatch.org).\\r","license":null,"license_link":null,"geographic_coverage":"Global","spatial_resolution":"30 m","date_of_content":"2000-2003, 2016-2019","frequency_of_updates":"Unknown","learn_more_link":"https://www.researchsquare.com/article/rs-294463/v1","data_download_link":null,"data_download_original_link":"https://www.researchsquare.com/article/rs-294463/v1"},"columns":{},"createdAt":"2021-09-30T20:20:11.559Z","updatedAt":"2021-10-19T18:42:03.966Z","status":"published"}}],"layer":[{"type":"layer","id":"croplad-extend-change","attributes":{"name":"2000-2003 and 2016-2019 Cropland Extent and Change","dataset":"test-dataset-4","description":"Stable cropland presence and absence, cropland change (gain and loss) between two epochs: 2000-2003 and 2016-2019. The cropland change refers to areas with cropland establishment (gain) and cropland abandonment or conversion to other land uses (loss) between 2000-2003 and 2016-2019 time intervals.","provider":"leaflet","type":"raster","layerConfig":{},"source":{"tiles":["https://storage.googleapis.com/lcl_tiles/GLCLU2020//cropland/{z}/{x}/{y}.png"],"minzoom":1,"maxzoom":12},"legendConfig":{"items":[{"color":"#FFF183","name":"Stable Cropland","id":1},{"color":"#fd8b2d","name":"Cropland Loss","id":2},{"color":"#35978f","name":"Cropland Gain","id":3}],"type":"basic"}}}]}},{"type":"dataset","id":"test-dataset-5","attributes":{"name":"[internal] Snow/Ice Extent and Change","active":true,"subtitle":"","metadata":[{"id":"613f8f271f59a5001b0e2488","type":"metadata","attributes":{"dataset":"5a796ce9-71d4-42b0-922d-056a86e5eb72","application":"rw","resource":{"id":"5a796ce9-71d4-42b0-922d-056a86e5eb72","type":"dataset"},"language":"en","name":"Snow/Ice Extent and Change","description":"### Overview  \\n  \\n_**The Snow/Ice data is still a draft product and data are subject to change in the future.**_\\r\\n  \\n  \\nThe Snow/Ice Extent and Change dataset at 30 m spatial resolution was developed by the Global Land Analysis and Discovery Lab (GLAD) at the University of Maryland (UMD) using Landsat satellite data time-series. The map shows the extent of glaciers and perennial snowfields and their change from the year 2000 to 2020. Areas with seasonal snow cover are excluded from the map. The map extent is limited to continents and large islands between 75\xb0N and 56\xb0S [(Potapov et al., 2020)](https://doi.org/10.3390/rs12030426). Greenland, the Antarctic, and Arctic Islands are excluded from the map. Model calibration data were collected through the visual interpretation of Landsat and high spatial resolution satellite images. A set of regionally calibrated models were developed and implemented to map perennial snow and ice cover time-series. The snow/ice loss represents areas where the year 2000 perennial snow or ice cover was transformed into seasonal snow cover or completely disappeared by the year 2020. The gain areas represent the expansion of perennial snowfields and glaciers from the year 2000 to 2020.\\r\\n  \\n  \\nThe GLAD laboratory in the Department of Geographical Sciences at UMD investigates methods, causes, and impacts of global land surface change.  Earth observation imagery is the primary data source, and the land cover extent and change is the primary topic of interest. GLAD aspires to generate new science insights concerning land resources, educate the next generation of remote sensing-based land change scientists, and disseminate land monitoring capabilities to operational settings nationally and internationally.\\r\\n  \\n  \\n### Methodology  \\n  \\nThe source mapped permanent snow and ice using regionally calibrated supervised classification models (decision tree ensembles). The classification model was calibrated with manually collected training data from multitemporal Landsat metrics. The source used the Landsat data from the years 2000, 2005, and 2020 for training data collection. For each year, The source selected Landsat observations during the peak land surface temperature and peak vegetation index values to separate perennial and annual snow cover. The training data from different years were integrated and used to create a single regional model. Overall, the source created fourteen regional models, one model per mountain system or a geographic region. The source iterated the models until the results were sufficiently correct. The final product was filtered using a set of rules to remove noise in the time series and possible omission/commission due to the remaining cloud/cloud shadow contamination of Landsat data.\\n  \\n  \\nFor the full documentation, please click on the \u201cLearn more\u201d button.  \\n  \\n### Additional Information  \\n  \\nResource Watch shows only a subset of the dataset. For access to the full dataset and additional information, click on the \u201cLearn more\u201d button.  \\n  \\n### Visualizing the Data  \\n  \\nOur team reformatted this dataset before displaying it on Resource Watch.\\n  \\n  \\n### Disclaimer  \\n  \\nExcerpts of this description page were taken from the source metadata.","source":"UMD","info":{"rwId":"cli.001.rw0","data_type":"Raster","name":"Snow/Ice Extent and Change","sources":[{"source-name":"","id":0,"source-description":"University of Maryland (UMD)"}],"technical_title":"Global glaciers and perennial snowfields extent and change, 2000-2020","functions":"[Draft] Global glaciers and perennial snowfields extent, loss, and gain from the year 2000 to 2020","cautions":"- A probability-based sample analysis is the recommended good practice approach to estimating land cover and land use extent and change. The global land cover map time-series enables a higher sampling efficiency through stratification at the sub-national, national, and global scales. The maps should not be used as the only source data for national and international reporting due to unknown map uncertainty that may vary in space and between time intervals.\\r\\n  \\n  \\n - The model performance is compromised by the low radiometric resolution and observation frequency of Landsat TM and ETM+ data in the year 2000 compared to the Landsat ETM+ and OLI data in 2020. The year 2000 map overestimated the area of perennial snow and ice due to the inclusion of seasonal snow and classification errors within topographic shadows. As a result, the rate of snow and ice reduction from the year 2000 to 2020 is overestimated by the map. The areas of snow and ice gain and loss should be considered as indicator products. \\r\\n  \\n  \\n - The product quality depends on the availability of Landsat data during the hottest time of the year. The absence of cloud-free Landsat data during the hottest month may cause an overestimation of perennial snow cover. Small Arctic lakes can be classified as \u201cpermanent snow\u201d if no cloud-free observations during the hottest time of the years were available for several years in a row. Confusion of snow/ice with clouds may compromise model performance in regions with persistent cloud cover.\\r\\n  \\n  \\n - Dirt, soot, and volcanic ash on top of the glaciers may compromise their detection. This issue affected data near active volcanos in Iceland and Kamchatka and may compromise detection of melting glaciers covered with rocks and sand.","citation":"Potapov, P., Turubanova, S., Hansen, M.C., Tyukavina, A., Khan, A., Pickens, A., 2021. Global extent and change of glaciers and perennial snowfields, 2000-2020. GLAD UMD Dataset. Accessed through Resource Watch, (date). [www.resourcewatch.org](https://www.resourcewatch.org).","license":null,"license_link":null,"geographic_coverage":"75N - 56S","spatial_resolution":"30 m","date_of_content":"2000-2020","frequency_of_updates":"Unknown","learn_more_link":"https://doi.org/10.3390/rs12030426","data_download_link":null,"data_download_original_link":"https://doi.org/10.3390/rs12030426"},"columns":{},"createdAt":"2021-09-13T17:49:27.133Z","updatedAt":"2021-10-19T18:36:29.813Z","status":"published"}}],"layer":[{"type":"layer","id":"snow-ice-extent-change","attributes":{"name":"2000-2020 Snow/Ice extent and change","dataset":"test-dataset-5","description":"The snow/ice loss represents areas where the year 2000 perennial snow or ice cover was transformed into seasonal snow cover or completely disappeared by the year 2020. The gain areas represent the expansion of perennial snowfields and glaciers from the year 2000 to 2020.","provider":"leaflet","type":"raster","layerConfig":{},"source":{"tiles":["https://storage.googleapis.com/lcl_tiles/GLCLU2020//snow/{z}/{x}/{y}.png"],"minzoom":1,"maxzoom":12},"legendConfig":{"items":[{"color":"#acd1e8","name":"Stable Snow/Ice","id":0},{"color":"#c95542","name":"Snow/Ice Loss","id":1},{"color":"#2379ad","name":"Snow/Ice Gain","id":2}],"type":"basic"}}}]}},{"type":"dataset","id":"test-dataset-6","attributes":{"name":"[internal] Built Up Extent and Change","active":true,"subtitle":"","metadata":[{"id":"613f8f271f59a5001b0e2488","type":"metadata","attributes":{"dataset":"5a796ce9-71d4-42b0-922d-056a86e5eb72","application":"rw","resource":{"id":"5a796ce9-71d4-42b0-922d-056a86e5eb72","type":"dataset"},"language":"en","name":"Built Up Extent and Change","description":"","source":"UMD","info":{"rwId":"cli.001.rw0","data_type":"Raster","name":"Built Up Extent and Change","sources":[{"source-name":"","id":0,"source-description":"University of Maryland (UMD)"}],"technical_title":"","functions":"","cautions":"","citation":"","license":null,"license_link":null,"geographic_coverage":"75N - 56S","spatial_resolution":"30 m","date_of_content":"2000-2020","frequency_of_updates":"Unknown","learn_more_link":"https://doi.org/10.3390/rs12030426","data_download_link":null,"data_download_original_link":"https://doi.org/10.3390/rs12030426"},"columns":{},"createdAt":"2021-09-13T17:49:27.133Z","updatedAt":"2021-10-19T18:36:29.813Z","status":"published"}}],"layer":[{"type":"layer","id":"built-up-extent-change","attributes":{"name":"2000-2020 Built Up Extent and Change","description":"","dataset":"test-dataset-6","provider":"leaflet","type":"raster","layerConfig":{},"source":{"tiles":["https://storage.googleapis.com/lcl_tiles/GLCLU2020/builtup/{z}/{x}/{y}.png"],"minzoom":1,"maxzoom":12},"legendConfig":{"items":[{"color":"#e8765d","name":"Stable Built Up","id":0},{"color":"#c43a35","name":"Built Up Gain","id":1}],"type":"basic"}}}]}}]}');function x(){return Promise.resolve((0,w.ZP)(v))}function j(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?j(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):j(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,y.useQuery)(["fetch-datasets",e],(function(){return x()}),k({},t))},_=a(219),D=a(3063),C=a(4184),T=a.n(C),L=a(1609),S=a.n(L),E=a(7013),A=a(8716),P=a(9302),N={dark:{id:"dark",value:"dark",label:"Dark",options:{attribution:'<a href="https://www.mapbox.com/about/maps/" target="_blank">\xa9 Mapbox</a> <a href="http://www.openstreetmap.org/about/" target="_blank">\xa9 OpenStreetMap</a>'}},light:{id:"light",value:"light",label:"Light",options:{attribution:'<a href="https://www.mapbox.com/about/maps/" target="_blank">\xa9 Mapbox</a> <a href="http://www.openstreetmap.org/about/" target="_blank">\xa9 OpenStreetMap</a>'}},satellite:{id:"satellite",value:"satellite",label:"Satellite",options:{attribution:'<a href="https://www.mapbox.com/about/maps/" target="_blank">\xa9 Mapbox</a> <a href="http://www.openstreetmap.org/about/" target="_blank">\xa9 OpenStreetMap</a>'}},terrain:{id:"terrain",value:"terrain",label:"Terrain",options:{attribution:'<a href="https://www.mapbox.com/about/maps/" target="_blank">\xa9 Mapbox</a> <a href="http://www.openstreetmap.org/about/" target="_blank">\xa9 OpenStreetMap</a>'}},aqueduct:{id:"aqueduct",value:"aqueduct",label:"Hydrography",options:{attribution:'<a href="https://www.mapbox.com/about/maps/" target="_blank">\xa9 Mapbox</a> <a href="http://www.openstreetmap.org/about/" target="_blank">\xa9 OpenStreetMap</a>'}}},z={none:{id:"none",label:"No labels",value:"none"},light:{id:"light",label:"Labels light",value:"light"},dark:{id:"dark",label:"Labels dark",value:"dark"}},M={zoom:2,latitude:0,longitude:0,pitch:0,bearing:0,transitionDuration:250,maxZoom:22,minZoom:1},I=a(5893),G=["mapboxApiAccessToken","children","className","viewport","bounds","basemap","labels","boundaries","onMapReady","onMapLoad","onMapViewportChange","dragPan","dragRotate","scrollZoom","touchZoom","touchRotate","doubleClickZoom","width","height","getCursor"];function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Z(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var B=function(e){var t=e.mapboxApiAccessToken,a=e.children,o=e.className,i=e.viewport,s=e.bounds,l=e.basemap,c=e.labels,d=e.boundaries,u=e.onMapReady,h=e.onMapLoad,p=e.onMapViewportChange,m=e.dragPan,f=e.dragRotate,g=e.scrollZoom,b=e.touchZoom,y=e.touchRotate,w=e.doubleClickZoom,v=e.width,x=void 0===v?"100%":v,j=e.height,k=void 0===j?"100%":j,O=e.getCursor,C=(0,_.Z)(e,G),L=(0,r.useRef)(null),N=(0,r.useRef)(null),z=(0,r.useState)(Z(Z({},M),i)),R=z[0],B=z[1],U=(0,r.useState)(!1),F=U[0],H=U[1],q=(0,r.useState)(!1),V=q[0],W=q[1],J=(0,r.useState)(!1),X=J[0],K=J[1],Y=(0,r.useCallback)((function(){if(!L.current)return!1;var e=["basemap"],t=L.current.getStyle(),a=t.layers,n=t.metadata,r=Object.keys(n["mapbox:groups"]).filter((function(t){var a=n["mapbox:groups"][t].name;return e.map((function(e){return a.toLowerCase().includes(e)})).some((function(e){return e}))})),o=r.map((function(e){return Z(Z({},n["mapbox:groups"][e]),{},{id:e})})).find((function(e){return e.name.includes(l)})),i=a.filter((function(e){var t=e.metadata;if(!t)return!1;var a=t["mapbox:group"];return r.includes(a)}));return!!o&&(i.forEach((function(e){e.metadata["mapbox:group"]===o.id?L.current.setLayoutProperty(e.id,"visibility","visible"):L.current.setLayoutProperty(e.id,"visibility","none")})),!0)}),[l]),Q=(0,r.useCallback)((function(){var e=["labels"],t=L.current.getStyle(),a=t.layers,n=t.metadata,r=Object.keys(n["mapbox:groups"]).filter((function(t){var a=n["mapbox:groups"][t].name;return e.filter((function(e){return a.toLowerCase().includes(e)})).some((function(e){return e}))})),o=r.map((function(e){return Z(Z({},n["mapbox:groups"][e]),{},{id:e})})).find((function(e){return e.name.includes(c)}))||{};return a.filter((function(e){var t=e.metadata;if(!t)return!1;var a=t["mapbox:group"];return r.includes(a)})).forEach((function(e){var t=e.metadata["mapbox:group"]===o.id;L.current.setLayoutProperty(e.id,"visibility",t?"visible":"none")})),!0}),[c]),$=(0,r.useCallback)((function(){var e=["boundaries"],t=L.current.getStyle(),a=t.layers,n=t.metadata,r=Object.keys(n["mapbox:groups"]).filter((function(t){var a=n["mapbox:groups"][t].name;return e.map((function(e){return a.toLowerCase().includes(e)})).some((function(e){return e}))}));a.filter((function(e){var t=e.metadata;if(!t)return!1;var a=t["mapbox:group"];return r.includes(a)})).forEach((function(e){L.current.setLayoutProperty(e.id,"visibility",d?"visible":"none")}))}),[d]),ee=(0,r.useCallback)((function(){K(!0),h&&h({map:L.current,mapContainer:N.current}),Y(),Q(),$()}),[h]),te=(0,P.Z)((function(e){p(e)}),250),ae=(0,r.useCallback)((function(e){B(e),te(e)}),[te]),ne=(0,r.useCallback)((function(e){var t=Z(Z({},R),e);B(t),te(t)}),[R,te]),re=(0,r.useCallback)((function(){if(!V)return null;var e=s.bbox,t=s.options,a=void 0===t?{}:t,n=s.viewportOptions,r=void 0===n?{}:n,o=r.transitionDuration,i=void 0===o?0:o;if(N.current.offsetWidth<=0||N.current.offsetHeight<=0)return console.error("mapContainerRef doesn't have dimensions"),null;var l=(0,E.Xg)(Z({width:N.current.offsetWidth,height:N.current.offsetHeight,bounds:[[e[0],e[1]],[e[2],e[3]]]},a)),c=Z({longitude:l.longitude,latitude:l.latitude,zoom:l.zoom,transitionDuration:i,transitionInterruption:D.r8.UPDATE},r);return H(!0),B((function(e){return Z(Z({},e),c)})),te(c),setTimeout((function(){H(!1)}),+i)}),[V,s,te]),oe=(0,r.useCallback)((function(e){var t=e.isHovering,a=e.isDragging;return t?"pointer":a?"grabbing":"grab"}),[l]);return(0,r.useEffect)((function(){W(!0),u&&u({map:L.current,mapContainer:N.current})}),[u]),(0,r.useEffect)((function(){!S()(s)&&s.bbox&&s.bbox.every((function(e){return!!e}))&&re()}),[s,re]),(0,r.useEffect)((function(){B((function(e){return Z(Z({},e),i)}))}),[i]),(0,r.useEffect)((function(){X&&Y()}),[l]),(0,r.useEffect)((function(){X&&Q()}),[c]),(0,r.useEffect)((function(){X&&$()}),[d]),(0,I.jsx)("div",{ref:N,className:T()((0,n.Z)({"relative w-full h-full z-0":!0},o,!!o)),children:(0,I.jsx)(D.ZP,Z(Z(Z({ref:function(e){e&&(L.current=e.getMap())},mapboxApiAccessToken:t,mapStyle:"mapbox://styles/resourcewatch/cjzmw480d00z41cp2x81gm90h"},C),R),{},{width:x,height:k,dragPan:!F&&m,dragRotate:!F&&f,scrollZoom:!F&&g,touchZoom:!F&&b,touchRotate:!F&&y,doubleClickZoom:!F&&w,onViewportChange:ae,onResize:ne,onLoad:ee,getCursor:O||oe,transitionInterpolator:new D.Cf,transitionEasing:A.tw,children:V&&X&&!!L.current&&"function"===typeof a&&a(L.current)}))})},U=a(1076),F=function(e){var t=e.active,a=void 0===t||t,n=e.meta,o=e.disabled;return(0,r.useMemo)((function(){return o?"disabled":n.touched&&n.error?"error":a&&n.touched&&n.valid?"valid":"none"}),[a,n,o])},H={dark:{base:"bg-black border rounded-sm text-blue-500 focus:border-blue-500",status:{none:"border-gray-500",valid:"border-gray-500",error:"border-red-500 focus:border-red-500",disabled:"border-gray-500 opacity-50"}},light:{base:"bg-white border rounded-sm text-blue-500 focus:border-blue-500",status:{none:"border-gray-800",valid:"border-gray-800",error:"border-red-500 focus:border-red-500",disabled:"border-gray-800 opacity-50"}}},q=["theme","input","meta","disabled","className"];function V(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function W(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?V(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):V(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var J=function(e){var t,a=e.theme,r=void 0===a?"light":a,o=e.input,i=e.meta,s=void 0===i?{}:i,l=e.disabled,c=void 0!==l&&l,d=e.className,u=(0,_.Z)(e,q),h=F({meta:s,disabled:c});return(0,I.jsx)("input",W(W(W({},o),u),{},{type:"checkbox",disabled:c,className:T()((t={"form-checkbox":!0},(0,n.Z)(t,H[r].base,!0),(0,n.Z)(t,H[r].status[h],!0),(0,n.Z)(t,d,!!d),t))}))},X={dark:{base:"bg-gray-800 border rounded-full text-blue-500",status:{none:"border-gray-800",valid:"border-green-800",error:"border-red-500",disabled:"border-gray-800 opacity-50"}},light:{base:"bg-white border rounded-full text-blue-500",status:{none:"border-gray-800",valid:"border-green-800",error:"border-red-500 focus:border-red-500",disabled:"border-gray-800 opacity-50"}}},K=["theme","disabled","input","meta","className"];function Y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Q(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var $=function(e){var t,a=e.theme,r=void 0===a?"light":a,o=e.disabled,i=void 0!==o&&o,s=e.input,l=void 0===s?{}:s,c=e.meta,d=void 0===c?{}:c,u=e.className,h=(0,_.Z)(e,K),p=F({active:!!l.checked,meta:d,disabled:i});return(0,I.jsx)("input",Q(Q(Q({},l),h),{},{type:"radio",disabled:i,className:T()((t={"form-radio":!0},(0,n.Z)(t,X[r].base,!0),(0,n.Z)(t,X[r].status[p],!0),(0,n.Z)(t,u,!!u),t))}))},ee=function(e){var t=e.icon,a=e.className,r=void 0===a?"w-5 h-5":a,o=e.style;return(0,I.jsx)("svg",{className:T()((0,n.Z)({"fill-current":!0},r,r)),viewBox:(null===t||void 0===t?void 0:t.viewBox)||"0 0 32 32",style:o,children:(0,I.jsx)("use",{xlinkHref:"#".concat((null===t||void 0===t?void 0:t.id)||t)})})},te=a(302),ae=a.n(te),ne=function(e){var t=e.basemap,a=e.labels,n=e.boundaries,o=e.onChangeBasemap,i=e.onChangeLabels,s=e.onChangeBoundaries,l=(0,r.useState)(!1),c=l[0],d=l[1],u=(0,r.useCallback)((function(e){var t=document.getElementById("basemap-selector");t&&t.contains&&!t.contains(e.target)&&d(!1)}),[]),h=(0,r.useCallback)((function(e){o(N[e.target.value])}),[o]),p=(0,r.useCallback)((function(e){i(z[e.target.value])}),[i]),m=(0,r.useCallback)((function(e){s(e.target.checked)}),[s]);return(0,r.useEffect)((function(){return function(){document.removeEventListener("click",u)}}),[]),(0,r.useEffect)((function(){return c?window.addEventListener("click",u):window.removeEventListener("click",u),function(){window.removeEventListener("click",u)}}),[c]),(0,I.jsx)("div",{className:"mt-0.5",children:(0,I.jsx)(U.Z,{attachment:"top right",constraints:[{to:"window"}],targetOffset:"8px 100%",renderTarget:function(e){return(0,I.jsx)("button",{ref:e,type:"button",className:"mt-1 p-1.5 bg-white text-black",onClick:function(){d(!0)},children:(0,I.jsx)(ee,{icon:ae(),className:"w-5 h-5"})})},renderElement:function(e){return c?(0,I.jsxs)("div",{ref:e,className:"bg-white p-4 rounded",id:"basemap-selector",children:[(0,I.jsx)("ul",{className:"flex flex-col",children:Object.keys(N).map((function(e){return(0,I.jsxs)("li",{className:"flex items-center mt-1.5 first:mt-0",children:[(0,I.jsx)($,{name:"basemap",title:N[e].label,value:N[e].value,checked:t===N[e].value,onChange:h}),(0,I.jsx)("label",{htmlFor:N[e].label,className:"ml-1.5 text-sm font-normal antialiased text-rw-gray",children:N[e].label})]},N[e].id)}))}),(0,I.jsx)("div",{className:"border-t border-gray-200 my-3"}),(0,I.jsx)("ul",{className:"flex flex-col",children:Object.keys(z).map((function(e){return(0,I.jsxs)("li",{className:"flex items-center mt-1.5 first:mt-0",children:[(0,I.jsx)($,{name:"labels",title:z[e].label,value:z[e].value,checked:a===z[e].value,onChange:p}),(0,I.jsx)("label",{htmlFor:z[e].label,className:"ml-1.5 text-sm font-normal antialiased text-rw-gray",children:z[e].label})]},z[e].id)}))}),(0,I.jsx)("div",{className:"border-t border-gray-200 my-3"}),(0,I.jsxs)("div",{className:"flex items-center",children:[(0,I.jsx)(J,{name:"boundaries",title:"Boundaries",value:"boundaries",checked:n,onChange:m,className:"cursor-pointer"}),(0,I.jsx)("label",{htmlFor:"boundaries",className:"ml-1.5 text-sm font-normal antialiased text-rw-gray",children:"Boundaries"})]})]}):null}})})},re=a(1966),oe=a.n(re),ie=a(7183),se=a.n(ie),le=function(e){var t=e.className,a=e.viewport,o=e.onZoomChange,i=a.zoom,s=a.maxZoom,l=a.minZoom,c=(0,r.useCallback)((function(e){e.stopPropagation(),i+1<=s&&o(i+1)}),[i,s,o]),d=(0,r.useCallback)((function(e){e.stopPropagation(),i+1>=l&&o(i-1)}),[i,l,o]);return(0,I.jsxs)("div",{className:T()((0,n.Z)({"inline-flex flex-col":!0},t,!!t)),children:[(0,I.jsx)("button",{className:T()({"mb-0.5 p-1.5 text-black bg-white ":!0,"hover:bg-gray-100 active:bg-gray-600":i!==s,"opacity-50 cursor-default":i===s}),"aria-label":"Zoom in",type:"button",disabled:i===s,onClick:c,children:(0,I.jsx)(ee,{icon:oe()})}),(0,I.jsx)("button",{className:T()({"p-1.5 text-black bg-white":!0,"hover:bg-gray-100 active:bg-gray-600":i!==l,"opacity-50 cursor-default":i===l}),"aria-label":"Zoom out",type:"button",disabled:i===l,onClick:d,children:(0,I.jsx)(ee,{icon:se()})})]})},ce=a(4708),de=a(9641),ue=a(1279),he=a(3869),pe=a(1770),me=a(7217),fe=a.n(me),ge="absolute top-1/2 inset-x-4 sm:left-1/2 transform -translate-y-1/2 sm:-translate-x-1/2 outline-none bg-white flex flex-col flex-grow overflow-hidden rounded-3xl py-7",be={narrow:"sm:w-4/6 md:w-1/2 lg:w-5/12 xl:w-1/3 ".concat(ge),default:"sm:w-4/5 md:w-2/3 lg:1/2 xl:w-2/5 ".concat(ge),wide:"sm:w-10/12 md:w-10/12 lg:w-10/12 xl:w-8/12 ".concat(ge)};function ye(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function we(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ye(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ve=function(e){var t,a=e.title,o=e.open,i=e.dismissable,s=void 0===i||i,l=e.size,c=void 0===l?"default":l,d=e.children,u=e.className,h=e.onDismiss,p=(0,r.useRef)(),m=(0,ue.Ir)({isKeyboardDismissDisabled:!s,isDismissable:s,isOpen:o,onClose:h},p).overlayProps,f=(0,ue.dd)().modalProps,g=(0,ce.R)({"aria-label":a},p).dialogProps;return(0,ue.tk)({isDisabled:!o}),(0,I.jsx)(he.M,{children:o&&(0,I.jsx)(ue.Xj,{children:(0,I.jsx)(pe.E.div,{initial:{opacity:0},animate:{opacity:1,transition:{delay:0}},exit:{opacity:0,transition:{delay:.125}},className:T()((0,n.Z)({},"z-50 fixed inset-0 bg-black bg-blur",!0)),children:(0,I.jsx)(de.MT,{contain:!0,restoreFocus:!0,autoFocus:!0,children:(0,I.jsx)("div",we(we(we(we({},m),g),f),{},{ref:p,children:(0,I.jsxs)(pe.E.div,{initial:{opacity:0,y:"-60%",x:"-50%"},animate:{opacity:1,y:"-50%",x:"-50%",transition:{delay:.125}},exit:{opacity:0,y:"-60%",x:"-50%",transition:{delay:0}},className:T()((t={},(0,n.Z)(t,be[c],!0),(0,n.Z)(t,u,!!u),t)),style:{maxHeight:"90%"},children:[s&&(0,I.jsx)("div",{className:"relative",children:(0,I.jsx)("button",{type:"button",onClick:h,className:"absolute flex items-center px-4 py-4 text-sm text-gray-300 right-4 -top-4 focus:text-black hover:text-black focus:outline-none",children:(0,I.jsx)(ee,{icon:fe(),className:"inline-block w-3 h-3 ml-2 text-black"})})}),r.Children.map(d,(function(e){return(0,r.isValidElement)(e)?(0,r.cloneElement)(e,{onDismiss:h}):null}))]})}))})})})})},xe=a(8330),je=a(1508),ke=a(266),Oe=a(8216),_e=a(5997),De=a(3444),Ce=a(982),Te=a(2953),Le=a(809),Se=a.n(Le),Ee=a(4155),Ae=function(e){var t=e.width,a=e.height,n=e.zoom,r=e.lat,o=e.lng,i=e.layerConfig;if(!i)throw Error("layerConfig param is required");if(!i.body)throw Error("layerConfig does not have body param");var s=i.body,l=i.account,c={version:"1.3.0",stat_tag:"API",layers:s.layers},d="?stat_tag=API&config=".concat(encodeURIComponent(JSON.stringify(c))),u="https://".concat(l,".carto.com/api/v1/map").concat(d);return fetch(u).then((function(e){if(e.status>=400)throw new Error(e.json());return e.json()})).then((function(e){var i=e.layergroupid;return"https://".concat(e.cdn_url.https,"/").concat(l,"/api/v1/map/static/center/").concat(i,"/").concat(n,"/").concat(r,"/").concat(o,"/").concat(t,"/").concat(a,".").concat("png")}))},Pe=function(e){var t=e.width,a=e.height,n=e.layerConfig;if(!n)throw Error("layerConfig param is required");if(!n.body)throw Error("layerConfig does not have body param");var r=n.body.url,o=encodeURIComponent(JSON.stringify({wkid:4326})),i=encodeURIComponent(JSON.stringify({wkid:3857}));return"".concat(r,"/export?bbox=").concat("-125.15625000000001,-55.7765730186677,85.78125,72.81607371878991","&bboxSR=").concat(o,"&layers=&layerDefs=&size=").concat(t,"%2C").concat(a,"&imageSR=").concat(i,"&format=").concat("png","&transparent=true&dpi=&time=&layerTimeOptions=&dynamicLayers=&gdbVersion=&mapScale=&rotation=&f=image")},Ne=function(e){var t=e.width,a=e.height,n=e.zoom,r=e.lat,o=e.lng,i=e.format,s=e.layerSpec,l={account:"wri-01",body:{maxzoom:18,minzoom:3,layers:[{type:"mapnik",options:{sql:"SELECT the_geom_webmercator FROM gadm28_countries",cartocss:"#gadm28_countries { polygon-fill: #bbbbbb; polygon-opacity: 1; line-color: #FFFFFF; line-width: 0.5; line-opacity: 0.5; }",cartocss_version:"2.3.0"}}]}},c=l.account,d={version:"1.3.0",stat_tag:"API",layers:l.body.layers},u="?stat_tag=API&config=".concat(encodeURIComponent(JSON.stringify(d))),h="https://".concat(c,".carto.com/api/v1/map").concat(u);return fetch(h).then((function(e){if(e.status>=400)throw new Error("Bad response from server");return e.json()})).then((function(e){var l=e.layergroupid;return"gee"===s.provider||"nexgddp"===s.provider||"leaflet"===s.provider?"https://".concat(e.cdn_url.https,"/").concat(c,"/api/v1/map/").concat(l,"/0/0/0.").concat(i||"png"):"https://".concat(e.cdn_url.https,"/").concat(c,"/api/v1/map/static/center/").concat(l,"/").concat(n,"/").concat(r,"/").concat(o,"/").concat(t,"/").concat(a,".").concat(i||"png")}))},ze=function(e){var t=e.layerSpec,a=t.layerConfig;if(!a)throw Error("layerConfig param is required");if(!a.body)throw Error("layerConfig does not have body param");return"".concat(Ee.env.NEXT_PUBLIC_WRI_API_URL,"/v1/layer/").concat(t.id,"/tile/gee/0/0/0")},Me=function(e){var t,a,n=e.layerSpec;return null===n||void 0===n||null===(t=n.source)||void 0===t||null===(a=t.tiles)||void 0===a?void 0:a[0].replace("{z}","0").replace("{x}","0").replace("{y}","0")},Ie=function(){var e=(0,ke.Z)(Se().mark((function e(t){var a,n,r,o,i,s,l,c,d;return Se().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.width,n=t.height,r=t.zoom,o=t.lat,i=t.lng,s=t.layerSpec){e.next=3;break}throw Error("No layerSpec specified.");case 3:l=s.layerConfig,c=s.provider,e.t0=c,e.next="carto"===e.t0?7:"cartodb"===e.t0?17:"mapservice"===e.t0?27:"featureservice"===e.t0?29:"arcgis"===e.t0?31:"gee"===e.t0?33:"leaflet"===e.t0?35:37;break;case 7:return e.prev=7,e.next=10,Ae({width:a,height:n,zoom:r,lat:o,lng:i,layerConfig:l});case 10:d=e.sent,e.next=16;break;case 13:e.prev=13,e.t1=e.catch(7),d=null;case 16:return e.abrupt("break",38);case 17:return e.prev=17,e.next=20,Ae({width:a,height:n,zoom:r,lat:o,lng:i,layerConfig:l});case 20:d=e.sent,e.next=26;break;case 23:e.prev=23,e.t2=e.catch(17),d=null;case 26:return e.abrupt("break",38);case 27:case 29:case 31:return d=Pe({width:a,height:n,layerConfig:l}),e.abrupt("break",38);case 33:return d=ze({layerSpec:s}),e.abrupt("break",38);case 35:return d=Me({layerSpec:s}),e.abrupt("break",38);case 37:d=null;case 38:return e.abrupt("return",d);case 39:case"end":return e.stop()}}),e,null,[[7,13],[17,23]])})));return function(t){return e.apply(this,arguments)}}();function Ge(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Re(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ge(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ge(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Ze(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,Te.Z)(e);if(t){var r=(0,Te.Z)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return(0,Ce.Z)(this,a)}}var Be=function(e){(0,De.Z)(a,e);var t=Ze(a);function a(e){var n;return(0,Oe.Z)(this,a),(n=t.call(this,e)).state={imageSrc:"",basemapSrc:""},n}return(0,_e.Z)(a,[{key:"componentDidMount",value:function(){var e=(0,ke.Z)(Se().mark((function e(){var t,a,n,r,o,i,s,l,c,d,u,h,p;return Se().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getSize(),a=t.width,n=t.height,r=this.props,o=r.zoom,i=void 0===o?1:o,s=r.lat,l=void 0===s?20:s,c=r.lng,d=void 0===c?-20:c,u=r.layerSpec,e.next=4,Ie({width:a,height:n,zoom:i,lat:l,lng:d,layerSpec:u});case 4:return h=e.sent,e.next=7,Ne({width:a,height:n,zoom:i,lat:l,lng:d,layerSpec:u});case 7:p=e.sent,this.setStateAsync({imageSrc:h,basemapSrc:p});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setStateAsync",value:function(e){var t=this;return new Promise((function(a){t.setState(e,a)}))}},{key:"getSize",value:function(){return{width:this.chart&&this.chart.offsetWidth?this.chart.offsetWidth:100,height:this.chart&&this.chart.offsetHeight?this.chart.offsetHeight:100}}},{key:"render",value:function(){var e=this,t=this.state,a=t.imageSrc,n=t.basemapSrc,r=a&&""!==a?"url('".concat(a,"') , url('").concat(n,"')"):"url('".concat(n,"')");return(0,I.jsx)("div",{ref:function(t){e.chart=t},className:"w-full h-full bg-cover bg-center absolute left-0 rounded rounded-tr-none rounded-br-none",style:Re({},r&&{backgroundImage:r})})}}]),a}(r.Component);function Ue(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){var a=new Date(e),n=a.getTimezoneOffset(),r=new Date(a.getTime()+6e4*n);return t?"".concat(r.getMonth()+1,"/").concat(r.getDate(),"/").concat(r.getFullYear()):r.toDateString()}return null}var Fe=function(e){var t,a,n,o,s=e.dataset,l=e.layer,c=e.metadata,u=(0,i.I0)(),h=p((function(e){return e.activeDatasets})),m=Ue(s.dataLastUpdated,!0),f=(0,r.useMemo)((function(){return Boolean(h.find((function(e){return e===s.id})))}),[h,s]),g=(0,r.useCallback)((function(){u(f?(0,d.GR)(h.filter((function(e){return e!==s.id}))):(0,d.GR)([].concat((0,je.Z)(h),[s.id])))}),[s,h,f]);return(0,I.jsxs)("div",{className:T()({"flex flex-row relative rounded transition-all duration-200 shadow-rw-2 hover:shadow-rw-3 bg-white border transform hover:-translate-y-1.5":!0,"focus:shadow-rw":f,"border-gray-100":!f}),style:{minHeight:130},children:[(0,I.jsx)("div",{className:"flex w-3/6 relative",children:(0,I.jsx)(Be,{layerSpec:l})}),(0,I.jsxs)("div",{className:"flex-1 flex-col flex-grow justify-between p-2 w-3/6",children:[(0,I.jsxs)("div",{className:"flex justify-between",children:[(0,I.jsx)("div",{className:"text-xs font-bold text-rw-gray-2",title:null===c||void 0===c||null===(t=c[0])||void 0===t?void 0:t.source,children:null===c||void 0===c||null===(a=c[0])||void 0===a?void 0:a.source}),(0,I.jsx)("div",{className:"text-xs font-bold text-rw-gray-2",children:m})]}),(0,I.jsxs)("div",{className:"mt-2",children:[(0,I.jsx)("h4",{className:"text-rw-gray font-bold antialiased",children:(null===c||void 0===c||null===(n=c[0])||void 0===n||null===(o=n.info)||void 0===o?void 0:o.name)||s.name}),(0,I.jsx)("button",{type:"button",className:T()({"w-full mt-6 px-8 py-1 rounded bg-transparent text-sm antialiased border-rw-pink border focus:outline-none whitespace-nowrap":!0,"bg-rw-pink text-white":f,"text-rw-pink":!f}),onClick:g,children:f?"Active":"Add to map"})]})]})]})},He=function(e){var t=e.list;return(0,I.jsx)(I.Fragment,{children:t.map((function(e){var t;return(0,I.jsx)("div",{className:"dataset-card-list-item-container mt-2.5 first:mt-0",children:(0,I.jsx)(Fe,{dataset:e,layer:null===e||void 0===e||null===(t=e.layer)||void 0===t?void 0:t[0],metadata:e.metadata})},e.id)}))})},qe=a(5767),Ve=a.n(qe),We=a(2230),Je=a.n(We),Xe=function(){var e=(0,i.I0)(),t=p((function(e){return e.sidebar.isOpen})),a=O({},{placeholderData:[]}).data,n=(0,r.useCallback)((function(){e((0,xe.o7)(!t))}),[t]);return(0,I.jsxs)("div",{className:T()({"w-80 h-full bg-white z-10 absolute transition transform translate-x-0":!0,"-translate-x-full":t}),children:[(0,I.jsx)("button",{onClick:n,type:"button",className:"absolute bg-rw-gray-3  text-white -right-7 top-5 z-50 py-3 px-2 focus:outline-none",children:(0,I.jsx)(ee,{icon:t?Je():Ve(),className:"w-3"})}),(0,I.jsx)("div",{className:"p-4 overflow-y-auto h-full",children:(0,I.jsx)(He,{list:a})})]})},Ke=a(7739),Ye=a.n(Ke);function Qe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function $e(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Qe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var et=function(e,t){var a=Ye()(e,"dataset");return Object.keys(a).map((function(e){var n=a[e].find((function(e){var a,n=e.id;return!1===(null===(a=t[n])||void 0===a?void 0:a.visibility)}));return{id:e,dataset:e,visibility:!n,layers:a[e].map((function(e){return $e($e({},e),{},{active:Boolean(e.default),visibility:!n})}))}}))};function tt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function at(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?tt(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):tt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var nt={title:null,content:null},rt=function(){var e=(0,r.useState)(M),t=e[0],a=e[1],n=(0,r.useState)(nt),s=n[0],m=n[1],y=(0,r.useState)([]),w=y[0],v=y[1],x=(0,i.I0)(),j=p((function(e){return e.map.basemap})),k=p((function(e){return e.map.labels})),_=p((function(e){return e.map.boundaries})),D=p((function(e){return e.layers})),C=p((function(e){return e.activeDatasets})),T=(0,r.useCallback)((function(e){a(e)}),[]),L=(0,r.useCallback)((function(e){a((function(t){return at(at({},t),{},{zoom:e,transitionDuration:250})}))}),[]),S=(0,r.useCallback)((function(e){var t=e.id;x((0,h.J8)(t))}),[]),E=(0,r.useCallback)((function(e){x((0,h.nr)(e))}),[]),A=(0,r.useCallback)((function(e){var t=e.value;x((0,h.Uu)(t))}),[]),P=(0,r.useCallback)((function(e){v(e)}),[]),N=(0,r.useCallback)((function(e,t){x((0,u.Kx)({id:e.id,params:{opacity:t}}))}),[]),z=(0,r.useCallback)((function(e){x((0,u.Kx)({id:e.id,params:{visibility:!e.visibility}}))}),[]),G=(0,r.useCallback)((function(){}),[]),R=(0,r.useCallback)((function(e){x((0,d.GR)(C.filter((function(t){return t!==e.dataset}))))}),[C]),Z=O({},{placeholderData:[]}).data,U=(0,r.useMemo)((function(){return l()(Z.filter((function(e){var t=e.id;return C.includes(t)})).map((function(e){return e.layer.map((function(e){return at(at({},e),D[e.id]||{})}))}))).sort((function(e,t){return w.indexOf(e.dataset)>w.indexOf(t.dataset)?1:-1}))}),[Z,C,D,w]),F=(0,r.useMemo)((function(){return et(U,D)}),[U,D]),H=(0,r.useCallback)((function(e){var t,a,n,r=null===(t=Z.find((function(t){return t.id===e.dataset})))||void 0===t?void 0:t.metadata;m({title:null===r||void 0===r||null===(a=r[0])||void 0===a?void 0:a.name,content:null===r||void 0===r||null===(n=r[0])||void 0===n?void 0:n.description})}),[Z]);return(0,r.useEffect)((function(){var e=Z.filter((function(e){return e.active})).map((function(e){return e.id}));x((0,d.GR)(e))}),[Z]),(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(c.default,{children:(0,I.jsx)("title",{children:"Land Carbon Explorer"})}),(0,I.jsxs)("div",{className:"flex flex-col h-screen relative",children:[(0,I.jsx)(Xe,{}),(0,I.jsxs)("div",{className:"absolute top-0 left-0 right-0 h-full",children:[(0,I.jsx)(B,{mapboxApiAccessToken:"pk.eyJ1IjoicmVzb3VyY2V3YXRjaCIsImEiOiJjajFlcXZhNzcwMDBqMzNzMTQ0bDN6Y3U4In0.FRcIP_yusVaAy0mwAX1B8w",viewport:t,basemap:j,labels:k,boundaries:_,onMapViewportChange:T,children:function(e){return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(g.LayerManager,{map:e,plugin:f(),children:U.map((function(e){return(0,I.jsx)(g.Layer,at({},e),e.id)}))})})}}),(0,I.jsxs)("div",{className:"z-10 absolute top-10 right-5",children:[(0,I.jsx)(le,{viewport:t,onZoomChange:L}),(0,I.jsx)(ne,{basemap:j,labels:k,boundaries:_,onChangeBasemap:S,onChangeLabels:A,onChangeBoundaries:E})]}),(0,I.jsx)("div",{className:"z-10 absolute bottom-10 right-5",children:(0,I.jsx)(b.Legend,{maxHeight:300,onChangeOrder:P,children:F.map((function(e,t){return(0,I.jsx)(b.LegendListItem,{index:t,layerGroup:e,toolbar:(0,I.jsx)(b.LegendItemToolbar,{}),onChangeInfo:H,onChangeOpacity:N,onChangeVisibility:z,onChangeLayer:G,onRemoveLayer:R,children:(0,I.jsx)(b.LegendItemTypes,{})},e.id)}))})})]})]}),(0,I.jsx)(ve,{open:Boolean(s.content),onDismiss:function(){return m(nt)},title:s.title,children:(0,I.jsx)("div",{className:"p-6 overflow-y-auto",children:(0,I.jsx)(o.Z,{children:s.content})})}),(0,I.jsx)(b.Icons,{})]})}},5301:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(409)}])},1966:function(e,t,a){var n=a(7294),r=a(7854),o=a(5348),i=new r({id:"zoom-in-54941248--sprite",use:"zoom-in-54941248--sprite-usage",viewBox:"0 0 20 20",content:'<symbol viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" id="zoom-in-54941248--sprite">\n<path d="M15 8.91304H11.087V5H8.91304V8.91304H5V11.087H8.91304V15H11.087V11.087H15V8.91304Z" />\n</symbol>'});o.add(i);var s=function(e){return n.createElement("svg",Object.assign({viewBox:i.viewBox},e),n.createElement("use",{xlinkHref:"#"+i.id}))};s.viewBox=i.viewBox,s.id=i.id,s.content=i.content,s.url=i.url,s.toString=i.toString,e.exports=s,e.exports.default=s},7183:function(e,t,a){var n=a(7294),r=a(7854),o=a(5348),i=new r({id:"zoom-out-4420dc9b--sprite",use:"zoom-out-4420dc9b--sprite-usage",viewBox:"0 0 20 20",content:'<symbol viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" id="zoom-out-4420dc9b--sprite">\n<path d="M5 8.91309H15V11.087H5V8.91309Z" />\n</symbol>'});o.add(i);var s=function(e){return n.createElement("svg",Object.assign({viewBox:i.viewBox},e),n.createElement("use",{xlinkHref:"#"+i.id}))};s.viewBox=i.viewBox,s.id=i.id,s.content=i.content,s.url=i.url,s.toString=i.toString,e.exports=s,e.exports.default=s},5767:function(e,t,a){var n=a(7294),r=a(7854),o=a(5348),i=new r({id:"arrow-left-f562c1f6--sprite",use:"arrow-left-f562c1f6--sprite-usage",viewBox:"0 0 24 24",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="arrow-left-f562c1f6--sprite">\n<title>arrow-left-2</title>\n<path d="M18.844 2.813l-9.188 9.188 9.188 9.188-2.813 2.813-12-12 12-12z" />\n</symbol>'});o.add(i);var s=function(e){return n.createElement("svg",Object.assign({viewBox:i.viewBox},e),n.createElement("use",{xlinkHref:"#"+i.id}))};s.viewBox=i.viewBox,s.id=i.id,s.content=i.content,s.url=i.url,s.toString=i.toString,e.exports=s,e.exports.default=s},2230:function(e,t,a){var n=a(7294),r=a(7854),o=a(5348),i=new r({id:"arrow-right-07e601d2--sprite",use:"arrow-right-07e601d2--sprite-usage",viewBox:"0 0 24 24",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="arrow-right-07e601d2--sprite">\n<title>arrow-right-2</title>\n<path d="M7.969 0l12 12-12 12-2.813-2.813 9.188-9.188-9.188-9.188z" />\n</symbol>'});o.add(i);var s=function(e){return n.createElement("svg",Object.assign({viewBox:i.viewBox},e),n.createElement("use",{xlinkHref:"#"+i.id}))};s.viewBox=i.viewBox,s.id=i.id,s.content=i.content,s.url=i.url,s.toString=i.toString,e.exports=s,e.exports.default=s},7217:function(e,t,a){var n=a(7294),r=a(7854),o=a(5348),i=new r({id:"close-31a1ccb8--sprite",use:"close-31a1ccb8--sprite-usage",viewBox:"0 0 32 32",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="close-31a1ccb8--sprite">\n<title>close</title>\n<path d="M16 11.636l-11.636-11.636-4.364 4.364 11.636 11.636-11.636 11.636 4.364 4.364 11.636-11.636 11.636 11.636 4.364-4.364-11.636-11.636 11.636-11.636-4.364-4.364z" />\n</symbol>'});o.add(i);var s=function(e){return n.createElement("svg",Object.assign({viewBox:i.viewBox},e),n.createElement("use",{xlinkHref:"#"+i.id}))};s.viewBox=i.viewBox,s.id=i.id,s.content=i.content,s.url=i.url,s.toString=i.toString,e.exports=s,e.exports.default=s},302:function(e,t,a){var n=a(7294),r=a(7854),o=a(5348),i=new r({id:"layers-2f433e95--sprite",use:"layers-2f433e95--sprite-usage",viewBox:"0 0 34 32",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 34 32" id="layers-2f433e95--sprite">\n<title>layers2</title>\n<path d="M27.616 17.497l3.643 2.503-14.556 10-14.556-10 3.641-2.501 10.916 7.501 10.913-7.503zM31.255 12l-14.553 10-14.56-10 14.56-10 14.553 10z" />\n</symbol>'});o.add(i);var s=function(e){return n.createElement("svg",Object.assign({viewBox:i.viewBox},e),n.createElement("use",{xlinkHref:"#"+i.id}))};s.viewBox=i.viewBox,s.id=i.id,s.content=i.content,s.url=i.url,s.toString=i.toString,e.exports=s,e.exports.default=s},7672:function(){},5307:function(){}},function(e){e.O(0,[900,885,634,452,774,888,179],(function(){return t=5301,e(e.s=t);var t}));var t=e.O();_N_E=t}]);